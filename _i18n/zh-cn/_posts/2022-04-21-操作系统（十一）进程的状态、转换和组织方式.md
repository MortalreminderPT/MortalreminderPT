---
layout: post 
title: 操作系统（十一）进程的状态、转换和组织方式 
description: 进程（Process）是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。
date: 2022-04-21 16:38:00 +0800 
image: /images/covers/操作系统-cover2.png
tags:
- 操作系统
---

1. 目录
{:toc}

## 进程的状态

进程的状态分为运行、就绪、阻塞、创建和终止五种，其中**运行、就绪和阻塞**三种状态为**进程的基本状态**。

进程的整个生命周期中，大部分时间都处于三种基本状态。

单CPU情况下，同一时刻只会有一个进程处于运行态，多核CPU情况下，可能有多个进程处于运行态。

<img src='\images\posts\操作系统-进程-进程状态.svg'
  style="
    display: block;
    margin-left: auto;
    margin-right: auto; 
    zoom:100%;" />

### 创建态及就绪态

进程正在被创建时，它的状态是“创建态”，在这个阶段操作系统会为进程分配资源、初始化PCB；

当进程创建完成后，便进入“就绪态”；

处于**就绪态**的进程已经**具备运行条件**，但由于**没有空闲CPU**，就暂时不能运行。

### 运行态

系统中可能会有很多个进程都处于就绪态；

当CPU空闲时，操作系统就会选择一个就绪进程让它上处理机运行。

如果**一个进程此时在CPU上运行**，那么这个进程处于“**运行态**”。CPU会执行该进程对应的程序（执行指令序列）。

### 阻塞态

在进程运行的过程中，可能会请求**等待某个事件的发生（如等待某种系统资源的分配，或者等待其他进程的响应）**。

在这个事件发生之前，进程无法继续往下执行，此时**操作系统会让这个进程下CPU**，并让它进入“**阻塞态**”。

当CPU空闲时，又会选择另一个“就绪态”进程上CPU运行。

此后，若资源成功分配给阻塞进程，即阻塞进程所等待的事件已经发生，此时操作系统将进程转变为就绪态。

### 终止态

一个进程可以执行exit系统调用，请求操作系统终止该进程。
此时该进程会进入“终止态”，操作系统会让该进程下CPU，并回收内存空间等资源，最后还要回收该进程的PCB。

当终止进程的工作完成之后，这个进程就彻底消失了。

## 进程的状态转换

进程状态转换过程可以用进程五状态模型进行表示：

<img src='\images\posts\操作系统-进程-进程状态转换图.svg'
  style="
    display: block;
    margin-left: auto;
    margin-right: auto; 
    zoom:100%;" />

注意：
- 阻塞态→就绪态是不是进程自身能控制的，是一种**被动行为**。
- 运行态→阻塞态是一种进程自身做出的**主动行为**。
- **不能由阻塞态直接转换为运行态，也不能由就绪态直接转换为阻塞态**（因为进入阻塞态是进程主动请求的，必然需要进程在运行时才能发出这种请求）。

## 进程的组织方式

进程PCB中，会有一个变量state来表示进程的当前状态。如：1表示创建态、2表示就绪态、3表示运行态...
为了对同一个状态下的各个进程进行统一的管理，操作系统会将各个进程的PCB组织起来。

### 链接方式
在链接方式中，操作系统按照进程状态将PCB分为**多个队列**；操作系统持有**指向各个队列的指针**。

<img src='\images\posts\操作系统-进程-链接方式.jpg'
  style="
    display: block;
    margin-left: auto;
    margin-right: auto; 
    zoom:50%;" />

### 索引方式
在索引方式中，操作系统根据进程状态的不同，建立**几张索引表**；操作系统持有**指向各个索引表的指针**。

<img src='\images\posts\操作系统-进程-索引方式.jpg'
  style="
    display: block;
    margin-left: auto;
    margin-right: auto; 
    zoom:50%;" />
