---
layout: post
title: 计算机网络（二）Data Link层
description:
date: 2024-10-20 12:34:56 +0800
image: https://www.koombea.com/wp-content/uploads/2024/02/Essentials-of-Enterprise-Networking-1100x616.webp
tags:
- Computer Network
category: ['Computer Network']
---

1. 目录
{:toc}

数据链路层的主要目的是在两台相邻机器之间实现“帧”的可靠和高效通信。  
- **处理传输错误**：确保数据传输的完整性。  
- **流量控制**：调节发送方与接收方的速度差异，避免缓冲区溢出或传输中断。  

## 数据链路层的功能 (Functions of the Data Link Layer)

1. **为网络层提供定义良好的服务接口**  
   - 接收来自网络层的分组 (packet)，构造数据帧 (frame) 并传输。  
   - 确保网络层能够在可靠的基础上传输数据。  

2. **处理传输错误**  
   - 检测和纠正物理层可能引入的错误，确保数据帧的完整性。  

3. **数据流调节 (Flow Regulation)**  
   - 调节发送方与接收方之间的数据流量，避免数据丢失或缓冲区溢出。  

4. **其他具体功能**  
   - 流量控制：控制帧的传输速度以适配接收方能力。  
   - 差错检测与修复：发现并纠正传输中的错误。  

## 成帧 (Framing)

### 什么是成帧？ (What is Framing)
成帧是将连续的比特流分割为独立的、可管理的数据单元“帧”的过程。  
**目的**：在不可靠的物理层基础上，为数据传输提供可靠性。  

### 成帧方法 (Framing Methods)

1. **字符计数法 (Character Count)**  
   - 在帧头中记录帧的字符数量。  
   - 缺点：如果帧头数据损坏，会导致后续数据帧无法正确解析（连锁反应）。  

2. **字节填充法 (Byte Stuffing)**  
   - 使用特殊的“标志字节”标记每个帧的开始和结束。  
   - 如果标志字节出现在数据中，则进行字节填充以避免混淆。  

3. **位填充法 (Bit Stuffing)**  
   - 帧以特殊位模式 (01111110) 开始和结束。  
   - 若数据中出现连续5个1，则插入一个0，以避免与标志冲突。  

## 差错检测与修复 (Error Detection and Correction)

### 差错修复 (Error Correction)
- 适用于噪声较大的传输介质（如无线信道）。  
- 能够在不需要重传的情况下修复数据，适合不可靠的连接环境。  

### 差错检测 (Error Detection)
- 适用于错误率较低的传输介质（如高质量的有线连接）。  
- 更高效但需要重传数据。  

差错检测和修复的关键在于假设错误发生的最大次数。

## 汉明距离 (Hamming Distance)

汉明距离是指两个字符串在相应位置上不同字符的数量。  

- 数据长度为 $ n $ 位，通过编码增加 $ k $ 位校验码，形成 $ n+k $ 位的码字。  
- **d+1**：可以检测最多 d 个错误。  
- **2d+1**：可以修复最多 d 个错误。  

## 差错修复方法：汉明码 (Hamming Code)

- 校验位的数量与数据位长度相关，至少需要 $ k $ 位校验位。  
- 根据特定规则分配校验位，仅能修复 1 位错误。  

## 差错检测方法 (Error Detection Methods)

1. **奇偶校验 (Parity Check)**  
   - 统计数据中 1 的数量，添加一个奇偶校验位。  
   - 汉明距离为 2，能检测 1 位错误但无法修复。  

2. **互联网校验和 (Internet Checksum)**  
   - 基于 16 位字的校验和。  
   - 汉明距离为 2，适合检测 1 位错误。  

3. **循环冗余校验 (CRC)**  
   - 功能更强大的检测方法，通常使用 32 位 CRC。  
   - 汉明距离约为 4，能够检测甚至部分修复多个错误。  

## 差错检测方法的比较 (Comparison of Error Detection Methods)

| 方法              | 校验位长度 | 汉明距离 | 能力                         |
|-------------------|------------|----------|------------------------------|
| 奇偶校验 (Parity) | 1 位        | 2        | 检测 1 位错误                |
| 校验和 (Checksum) | 16 位       | 2        | 检测 1 位错误                |
| CRC               | 32 位       | 4        | 检测多位错误并可能部分修复   |

## 流量控制 (Flow Control)

### 流量控制问题
当发送方速度快于接收方处理速度时，可能导致缓冲区溢出或数据丢失。  

### 流量控制方法
1. **基于反馈的流量控制 (Feedback-based Flow Control)**  
   - 接收方向发送方发送控制信号以调节流量。  

2. **基于速率的流量控制 (Rate-based Flow Control)**  
   - 发送方按预设速率发送数据，无需接收方反馈。  

### 停等协议 (Stop and Wait Protocol)
- 每发送一帧后，发送方需等待接收方的确认（ACK）。  

### 滑动窗口协议 (Sliding Window Protocol)
允许发送方同时发送多帧数据，提高传输效率。  

1. **回退 N (Go-Back-N)**  
   - 发送方窗口大小为 $ N $，接收方窗口大小为 1。  
   - 出现错误时，重传错误帧及其后的所有帧。  

2. **选择性重传 (Selective Repeat)**  
   - 接收方窗口可以接收任意位置的帧，出错时只重传丢失的特定帧。  
   - 使用负确认（NAK）指示具体错误位置。  

## 链路利用率 (Link Utilization)

- **传输时间 (Tf)**：与帧大小和带宽相关。  
- **传播时间 (Tp)**：与物理距离相关。  

优化链路利用率需要平衡这些因素，例如 $ Tf = 2Tp $ 时达到最大利用率。

## 总结

数据链路层在计算机网络中扮演着关键角色：  
- 提供可靠的帧传输服务。  
- 实现有效的差错检测与修复。  
- 管理相邻节点间的通信。  
- 为网络层提供稳健接口，提升整个网络的通信效率与可靠性。  